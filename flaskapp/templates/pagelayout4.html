<!DOCTYPE HTML>
<html>
<head>
    <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js"></script>
    <!--<script src="http://d3js.org/d3.v2.js"></script> -->
</head>

<body>

    <div class = "container">
      <form  action="/" method="GET">

        <div class="form-group">
          <label for="date">Date:</label>
          <input type="int" id="inputdate" name='inputdate' placeholder="5960 ">
        </div>

        <div>
          <button type="submit" class="btn btn-default btn-lg">Go!</button>
        </div>
        
      </form>
    </div>





    <div id="viz"></div>

    <br>
    <br>
    <br>

    <div id="summWin"> Topic summary </div>



    <script type="text/javascript">



    /*
    sampleSVG.append("circle")
        .style("stroke", "gray")
        .style("fill", "white")
        .attr("r", 40)
        .attr("cx", 50)
        .attr("cy", 50)       
       .on("mouseover", function(){d3.select(this).transition().delay(100).duration(1000).attr("r", 10).style("fill", "black")  ;})
        .on("mouseout", function(){d3.select(this).transition().delay(100).duration(1000).attr("r", 40).style("fill", "white")  ;})
    */  

    var color = d3.scale.quantize()
                  .range(["#156b87", "#876315", "#543510", "#872815"])
                  .domain([0, 1]);

    // Show the information about a particular point.
    var display_summary = function (d) {
        d3.select("#summWin").text("Topic summary: " + d.summary + ". ");
    };


   // handle incoming data
    var callback = function(data) {

        var margin = 100;
        var w = 800 - margin, h = 300 - margin;
        var sampleSVG = d3.select("#viz")
            .append("svg")
            .attr("width", w + 2 * margin)
            .attr("height", h + 2 * margin)
            .append("svg:g")
            .attr("transform", "translate(" + margin + ", " + margin + ")");

    /*    var sampleSVG = d3.select("#viz")
            .append("svg")
            .attr("width", 700)
            .attr("height", 200)  */
            
        sampleSVG.selectAll("circle")
            .data(data)
            .enter().append("circle")
            .style("stroke", "gray")
            .style("fill", "white")
            .attr("cx", function(d){return 100*d.x;})
            .attr("cy", function(d){return 80;})
            .attr("r", function(d){return 7*d.area;})
            .style("fill", function (d) { return d.color; })
            .on("mouseover", display_summary)
        sampleSVG.selectAll("text")
            .data(data)
            .enter().append("text")
            .attr("x", function(d){return 100*d.x;})
            .attr("y", function(d){return 80;})
            .attr("text-anchor", "middle")
            .text(function(d){return d.keywords;});

    }

    {% if inputdate %}
        d3.json("/gdata?inputdate={{inputdate}}", callback);
    {% endif %}


    </script>
</body>

</html>